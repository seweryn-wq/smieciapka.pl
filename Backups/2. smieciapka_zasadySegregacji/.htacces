# Ustawienie prawidłowych typów MIME
AddType application/manifest+json    manifest.json
AddType application/x-web-app-manifest+json   .webapp
AddType text/cache-manifest         manifest
AddType application/javascript      js
AddType image/png                   png
AddType image/svg+xml              svg

# Włączenie kompresji
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/html text/plain text/xml application/xml application/javascript text/css application/json application/manifest+json
</IfModule>

# Nagłówki bezpieczeństwa i PWA
<IfModule mod_headers.c>
    # Włącz Service Worker dla całej domeny
    Header set Service-Worker-Allowed "/"

    # Nagłówki bezpieczeństwa
    Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains"

    # Cache Control dla statycznych zasobów
    <FilesMatch "\.(ico|pdf|jpg|jpeg|png|gif|js|css|svg)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>

    # Cache Control dla manifest.json
    <Files manifest.json>
        Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
    </Files>

    # Cache Control dla Service Worker
    <Files service-worker.js>
        Header set Cache-Control "max-age=0, no-cache, no-store, must-revalidate"
    </Files>
</IfModule>

# Przekierowanie na HTTPS
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
